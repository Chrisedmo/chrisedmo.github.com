(function(e,t){function u(e,t,n,r,i,s){var o;e.css(n,r+s);o=e.width();if(o>=t){e.css(n,"");return o==t?{match:"exact",size:parseFloat((parseFloat(r)-.1).toFixed(3))}:{match:"estimate",size:parseFloat((parseFloat(r)-i).toFixed(3))}}return!1}function a(e,n,r,i,s){var a=e.clone(!0).addClass("bigtext-cloned").css({"min-width":parseInt(r,10),width:"auto",position:"absolute",left:-9999,top:-9999}).appendTo(document.body),f=[],l=[],c=[],h=[];a.find(n).css({"float":"left",clear:"left"}).each(function(e){var n=t(this),a=[4,1,.4,.1],l;if(n.hasClass(o.EXEMPT_CLASS)){f.push(null);h.push(null);c.push(!1);return}var p=20,d=parseFloat(n.css("font-size")),v=n.width(),m=(v/d).toFixed(6),g=parseFloat(((r-p)/m).toFixed(3));e:for(var y=0,b=a.length;y<b;y++)t:for(var w=1,E=4;w<=E;w++){if(g+w*a[y]>i){g=i;break e}l=u(n,r,"font-size",g+w*a[y],a[y],"px");if(l!==!1){g=l.size;if(l.match=="exact")break e;break t}}h.push(r/g);if(g>i){f.push(i);c.push(!1)}else if(!!s&&g<s){f.push(s);c.push(!0)}else{f.push(g);c.push(!1)}}).each(function(e){var n=t(this),i=0,s=1,a;if(n.hasClass(o.EXEMPT_CLASS)){l.push(null);return}n.css("font-size",f[e]+"px");for(var c=1,h=5;c<h;c+=s){a=u(n,r,"word-spacing",c,s,"px");if(a!==!1){i=a.size;break}}n.css("font-size","");l.push(i)}).removeAttr("style");a.remove();return{fontSizes:f,wordSpacings:l,ratios:h,minFontSizes:c}}var n=0,r=t("head"),i=e.BigText,s=t.fn.bigtext,o={DEFAULT_MIN_FONT_SIZE_PX:null,DEFAULT_MAX_FONT_SIZE_PX:528,GLOBAL_STYLE_ID:"bigtext-style",STYLE_ID:"bigtext-id",LINE_CLASS_PREFIX:"bigtext-line",EXEMPT_CLASS:"bigtext-exempt",DEFAULT_CHILD_SELECTOR:"> div",childSelectors:{div:"> div",ol:"> li",ul:"> li"},noConflict:function(n){if(n){t.fn.bigtext=s;e.BigText=i}return o},init:function(){t("#"+o.GLOBAL_STYLE_ID).length||r.append(o.generateStyleTag(o.GLOBAL_STYLE_ID,[".bigtext * { white-space: nowrap; }",".bigtext ."+o.EXEMPT_CLASS+", .bigtext ."+o.EXEMPT_CLASS+" * { white-space: normal; }"]))},bindResize:function(n,r){if(t.throttle)t(e).unbind(n).bind(n,t.throttle(100,r));else{t.fn.smartresize&&(n="smartresize."+n);t(e).unbind(n).bind(n,r)}},getStyleId:function(e){return o.STYLE_ID+"-"+e},generateStyleTag:function(e,n){return t("<style>"+n.join("\n")+"</style>").attr("id",e)},clearCss:function(e){var n=o.getStyleId(e);t("#"+n).remove()},generateCss:function(e,t,n,r){var i=[];o.clearCss(e);for(var s=0,u=t.length;s<u;s++)i.push("#"+e+" ."+o.LINE_CLASS_PREFIX+s+" {"+(r[s]?" white-space: normal;":"")+(t[s]?" font-size: "+t[s]+"px;":"")+(n[s]?" word-spacing: "+n[s]+"px;":"")+"}");return o.generateStyleTag(o.getStyleId(e),i)},jQueryMethod:function(e){o.init();e=t.extend({minfontsize:o.DEFAULT_MIN_FONT_SIZE_PX,maxfontsize:o.DEFAULT_MAX_FONT_SIZE_PX,childSelector:"",resize:!0},e||{});return this.each(function(){var i=t(this).addClass("bigtext"),s=e.childSelector||o.childSelectors[this.tagName.toLowerCase()]||o.DEFAULT_CHILD_SELECTOR,u=i.width(),f=i.attr("id");if(!f){f="bigtext-id"+n++;i.attr("id",f)}e.resize&&o.bindResize("resize.bigtext-event-"+f,function(){o.jQueryMethod.call(t("#"+f),e)});o.clearCss(f);i.find(s).addClass(function(e,t){return[t.replace(new RegExp("\\b"+o.LINE_CLASS_PREFIX+"\\d+\\b"),""),o.LINE_CLASS_PREFIX+e].join(" ")});var l=a(i,s,u,e.maxfontsize,e.minfontsize);r.append(o.generateCss(f,l.fontSizes,l.wordSpacings,l.minFontSizes))})}};t.fn.bigtext=o.jQueryMethod;e.BigText=o})(this,jQuery);